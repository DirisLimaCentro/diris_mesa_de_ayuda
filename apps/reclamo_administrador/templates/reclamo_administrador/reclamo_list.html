{% extends 'dashboard.html' %}
{% load paginator i18n %}
{% block  container %}
<style>
     table {
            width: 30%;
            border-collapse: collapse;
         }
        td {
            border: 1px solid #000;
            height: 50px;
        }
    .rectangle {
            display: flex;
            height: 100%;
        }
        .col {
            flex: 1;
            height: 100%;
            border: 1px solid black
        }
        #leyenda {
            margin-left: 20px;
 
        .prioridad-1 {
            background-color: rgb(247, 93, 93); /* Color para Prioridad I */
            color: white; /* Texto en blanco para mejor visibilidad */
        }
        .prioridad-2 {
            background-color:  rgb(247, 247, 73); /* Color para Prioridad II */
        }
        .prioridad-3 {
            background-color: rgb(104, 199, 104); /* Color para Prioridad III */
            color: white; /* Texto en blanco para mejor visibilidad */
        }
</style>
    <div class="app-content content">
        <div class="content-wrapper">
            <div class="content-header row">
                <div class="content-header-left col-md-12 col-12 mb-2">
                    <div class="row breadcrumbs-top">
                        <div class="breadcrumb-wrapper col-12">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item active">Configuraciones</li>
                                <li class="breadcrumb-item active">Entidades</li>
                                <li class="breadcrumb-item ">
                                    <a href="{% url 'entidad:list' %}?anio={{ request.session.entidad_anio }}&mes={{ request.session.entidad_mes }}">Todas
                                        las entidades</a></li>
                                <li class="breadcrumb-item active">{{ title }}</li>
                            </ol>
                        </div>
                    </div>
                </div>
                <div class="content-header-right col-md-6 col-12">
                    <div class=" float-md-right">
                        <div class="col-sm-12 col-lg-12 col-xl-12">

                        </div>
                    </div>
                </div>
            </div>

            <div class="content-body">
                <div class="row">
                    <div class="col-2">
                        <div class="card pull-up">
                            <div class="card-content">
                                <div class="card-body" style="padding: 10px !important;">
                                    <div class="media d-flex">
                                        <div class="media-body text-left">
                                            <p class="h5 text-danger">AÑO: {{ request.session.entidad_anio }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="card pull-up">
                            <div class="card-content">
                                <div class="card-body" style="padding: 10px !important;">
                                    <div class="media d-flex">
                                        <div class="media-body text-left">
                                            <p class="h5 text-danger">MES: {{ mes_nombre }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <section>
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between">
                                    <h2 class="card-title">{{ title }}
                                        <strong class="text-primary">({{ page_obj.paginator.count }})</strong></h2>
                                        <div style="margin-right: 20px;;">
                                            <table id="leyenda" style="border: 1px solid black; width: 100%; ">
                                               <thead>
                                                   
                                                       <th >LEYENDA:</th>
                                                       
                                                   
                                               </thead>
                                               <tbody>
                                                   <tr>
                                                       <td class="prioridad-1">Prioridad I: Dentro de las primeras 48 horas</td>
                                                       <td class="prioridad-2">Prioridad II: Dentro de las primeras 72 horas</td>
                                                       <td class="prioridad-3">Prioridad III: Dentro de los primeros 5 días</td>
                                                   </tr>
                                               </tbody>
                                           </table>
                                       </div>
                                </div>

                                <div class="card-body collapse show">
                                    <div class="row">
                                        <div class="col-md-2">
                                            {% include 'genericfilters/filter_list.html' %}
                                        </div>
                                        <div class="col-md-10">

                                            {% trans "Usuarios" as placeholder %}
                                            {% include 'genericfilters/query_filter.html' %}

                                            <div class="table-responsive">
                                                <table class="table table-striped table-bordered ">
                                                    <thead>
                                                    <tr>
                                                        <th>#</th>
                                                        <th>Clasificaciones</th>

                                                        <th>Fecha de <br>reclamo</th>
                                                        <th>Usuario afectado</th>
                                                        <th>Usuario que <br> presenta el reclamo</th>
                                                        <th>Estado del reclamo</th>
                                                        <th>Resultado</th>
                                                        <th>Estado <br>(Indicador)</th>
                                                        <th>Medio</th>
                                                        <th>Fecha de notificación <br> del reclamo</th>
                                                        <th>Fecha de <br>registro</th>
                                                        <th>Medidas <br>adoptadas</th>
                                                        <th>Expediente</th>
                                                        <th>OPC</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for object in object_list %}
                                                        <tr>
                                                            <th>{{ forloop.counter0|add:page_obj.start_index }}</th>
                                                            <td><div class="rectangle">
                                                                {% if object.prioridad_clasificador_1 ==  1  %} 
                                                                <div class="col" style="background-color: rgb(247, 93, 93);"></div>
                                                                  {%   elif  object.prioridad_clasificador_1 == 2    %}
                                                                <div class="col" style="background-color: rgb(247, 247, 73);"></div>
                                                                {%   elif  object.prioridad_clasificador_1 == 3    %}
                                                                <div class="col" style="background-color: rgb(104, 199, 104);"></div>
                                                                {% else %}
                                                                <div class="col" style="background-color: transparent;"></div>
                                                                 
                                                                {% endif %} 
       
       
                                                                {% if object.prioridad_clasificador_2 ==  1  %} 
                                                                <div class="col" style="background-color: rgb(247, 93, 93);"></div>
                                                                  {%   elif  object.prioridad_clasificador_2 == 2    %}
                                                                <div class="col" style="background-color: rgb(247, 247, 73);></div>
                                                                {%   elif  object.prioridad_clasificador_2 == 3    %}
                                                                <div class="col" style="background-color: rgb(104, 199, 104);"></div>
                                                                {% else %}
                                                                <div class="col" style="background-color: transparent;"></div>
                                                                 
                                                                {% endif %} 
                                                                
       
                                                                {% if object.prioridad_clasificador_3 ==  1  %} 
                                                                <div class="col" style="background-color: rgb(247, 93, 93);"></div>
                                                                  {%   elif  object.prioridad_clasificador_3 == 2    %}
                                                                <div class="col" style="background-color: rgb(182, 182, 77);></div>
                                                                {%   elif  object.prioridad_clasificador_3 == 3    %}
                                                                <div class="col" style="background-color: rgb(104, 199, 104);"></div>
                                                                {% else %}
                                                                <div class="col" style="background-color: transparent;"></div>
                                                                 
                                                                {% endif %} 
                                                               
                                                            </div></td>
                                                            <td>{{ object.fecha_reclamo|default_if_none:"" }}</td>
                                                            {#                                                            <td>{{ object.codigo_administrador|default_if_none:"" }}</td>#}
                                                            <td>{{ object.numero_documento_usuario|default_if_none:"" }}
                                                                -
                                                                {{ object.razon_social_usuario|default_if_none:"" }}
                                                                {{ object.nombres_usuario|default_if_none:"" }}
                                                                {{ object.apellido_paterno_usuario|default_if_none:"" }}
                                                                {{ object.apellido_materno_usuario|default_if_none:"" }}
                                                            </td>
                                                            <td>{{ object.numero_documento_presenta|default_if_none:"" }}
                                                                -
                                                                {{ object.razon_social_presenta|default_if_none:"" }}
                                                                {{ object.nombres_presenta|default_if_none:"" }}
                                                                {{ object.apellido_paterno_presenta|default_if_none:"" }}
                                                                {{ object.apellido_materno_presenta|default_if_none:"" }}
                                                            </td>
                                                            <td>{{ object.get_estado_reclamo_display|default_if_none:"--" }}</td>
                                                            <td>{{ object.get_resultado_reclamo_display|default_if_none:"--" }}</td>
                                                            <td>
                                                                {% if object.resultado_reclamo == 0 %}
                                                                    <span class="badge badge-pill badge-danger">Sin atender</span>
                                                                {% else %}
                                                                    <span class="badge badge-pill badge-success">Atendido</span>
                                                                {% endif %}
                                                                {##}
                                                                {##}
                                                                {#                                                                {% if object.get_estado %}#}
                                                                {#                                                                    <span class="badge badge-pill badge-success">Atendido</span>#}
                                                                {#                                                                {% else %}#}
                                                                {#                                                                    <span class="badge badge-pill badge-danger">Sin atender</span>#}
                                                                {#                                                                {% endif %}#}
                                                            </td>

                                                            <td>
                                                                <span>{{ object.get_medio_presentacion_display }}</span>
                                                                {{ object.servicio_hecho_reclamo }}
                                                                {% if object.servicio_hecho_reclamo  == '77' and object.medio_presentacion == 1 %}
                                                                    <h4 class="text-danger">PROCESO</h4>
                                                                {% endif %}
                                                            </td>

                                                            <td>{{ object.fecha_notificacion|default_if_none:"--" }}</td>
                                                            <td>{{ object.created_at }}</td>
                                                            <td>{{ object.medidas_adoptadas.count|default_if_none:"--" }}</td>
                                                            <td>
                                                                {% if object.expediente %}
                                                                    <a href="{{ object.expediente.url }}"
                                                                       target="_blank"> Expediente</a>
                                                                {% endif %}
                                                            </td>
                                                            <td class="text-center">
                                                                <a data-toggle="tooltip" data-placement="top"
                                                                   title="Ver reclamos"
                                                                   class="btn btn-warning btn-sm"
                                                                   href="{% url  'administrador:reclamo-detail' object.id %}">
                                                                    <i class="ft ft-eye font-medium-2"></i></a>

                                                            </td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                            {% paginator %}
                                        </div>
                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

{% endblock container %}

{% block static %}

{% endblock static %}
